#! /bin/sh
set -e

CDIMAGE_ROOT=/srv/cdimage.no-name-yet.com
. "$CDIMAGE_ROOT/etc/config"

SCRATCH="$CDIMAGE_ROOT/scratch/tasks"
TASKS="$CDIMAGE_ROOT/debian-cd/tasks"

mkemptydir () {
	rm -rf "$1"
	mkdir -p "$1"
}

mkemptydir "$SCRATCH"
cd "$SCRATCH"
CF="$CDIMAGE_ROOT/debian-cd/CONF.sh" \
	"$CDIMAGE_ROOT/debian-cd/tools/warty-update"

for seed in base desktop ship supported; do
	diff -u "$TASKS/$seed-$DIST" "$SCRATCH/$seed-$DIST" || true
done
